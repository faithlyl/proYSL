$(function(){var a=$.cookie("COOKIE_MEMBER_SEX");var c="";if(a==null||a==undefined||a==""){var b=$.trim($("#landingdefault").val());if(b==""||b==null||b==undefined){c=loxia.syncXhrGet("/index",{})}else{c=loxia.syncXhrGet(b,{})}}else{if(a=="default"){c=loxia.syncXhrGet("/index",{})}else{c=loxia.syncXhrGet(a,{})}}$("#indexchange").html(c);$.spice.tools.changeImageSrc({elem:"img[data-image]:not(.swiper-container img[data-src][data-image])",callBack:function(e,d){$.spice.lazyLoad("img[lazySrc]",{attr:d.opt.lazyData,prestrain:1})}});Y.dialog.videoDialog=$.spice.dialog({template:$("#play-video-dialog").html(),dialogClass:"video-dialog",initEvent:function(f){var d=f.data.dialog;$(".icon-video-close",d.elem).on("tap",function(){d.hide()});d.elem.on("dialog.show-before",function(){var e=$("[video-src]").attr("video-src"),g=e?'<iframe frameborder="no" src="'+e+'"></iframe>':"";$(".e-play-boxs").append(g)});d.elem.on("dialog.show-after",function(){});d.elem.on("dialog.hide-before",function(){$("[video-src]").removeAttr("video-src");$(".e-play-boxs iframe").attr("src","");$(".e-play-boxs iframe").remove()});d.elem.on("dialog.hide-after",function(){$(".e-play-boxs iframe").attr("src","");$(".e-play-boxs iframe").remove()})}})});
$(function(){var e=$.spice,f=$(window);e.tools.changeImageSrc({elem:".swiper-container img[data-src][data-image]",lazyData:"data-src"});var d=new Swiper(".e-swiper-kv",{autoplay:3000,speed:600,loop:true,lazyLoading:true,lazyLoadingOnTransitionStart:true,pagination:".swiper-pagination",paginationClickable:true,nextButton:".e-swiper-kv .swiper-button-next",prevButton:".e-swiper-kv .swiper-button-prev",onInit:function(g){setTimeout(function(){$(".article-kv .e-swiper-kv img").removeAttr("height")},300);if(g.bullets.length==1){g.destroy(false,true)}},onSlideChangeStart:function(g){}});function b(g){var i=g?g:$(".goods-tab-item.is-active .e-swiper-goods");i.each(function(m,n){var l=$(n).data("spice.swiper");if(!l){var k=$(n).siblings(".swiper-button-prev"),j=$(n).siblings(".swiper-button-next");l=new Swiper(n,{speed:400,lazyLoading:true,slidesPerView:3,spaceBetween:20,threshold:20,slidesPerGroup:3,pagination:".swiper-pagination",paginationClickable:true,prevButton:k[0],nextButton:j[0],breakpoints:{1024:{slidesPerView:2,spaceBetween:30,slidesPerGroup:2}}});$(n).data("spice.swiper",l)}else{l.update()}});var h=i.find(".e-swiper-color");h.each(function(l,m){var k=$(m).data("spice.swiper");if(!k){var j=$(m).siblings(".swiper-button-prev"),n=$(m).siblings(".swiper-button-next");k=new Swiper(m,{speed:400,slidesPerView:5,spaceBetween:0,lazyLoading:true,lazyLoadingClass:"my-lazy",prevButton:j[0],nextButton:n[0],breakpoints:{1250:{slidesPerView:4,},1024:{slidesPerView:8,},767:{slidesPerView:5,},360:{slidesPerView:4,}},onInit:function(o){$("span",o.slides).off().on("tap",function(){$(this).closest(".swiper-slide").addClass("is-active").siblings().removeClass("is-active");$(this).closest(".thumbnail").find(".img-box > a img").attr("src",$(this).data("img-src"));var p=$(this).parents(".thumbnail");var q=$(this).attr("data-presellLabel");var u=$(this).attr("data-itemCount");var t=$(this).attr("data-itemTagUp");var s=$(this).attr("data-soldout");if(!isNullOrEmpty(q)){var v="";var r="预售";if(q=="PRESELL_WAITING"){v="敬请期待"}else{if(q=="PRESELL_PURCHASE"){v="抢先预订"}else{if(q=="PRESELL_SELL_OUT"){v="售罄";r="售罄"}else{v="预售已结束"}}}$(".homepage-presell-copywriter-event",p.find(".img-box.recommend-homepage-img-box")).text(v);$(".homepage-presell-mob-copywriter-event",p.find(".details-box.recommend-homepage-details-box")).text(v);$(".homepage-presell-tag-event",p.find(".img-box.recommend-homepage-img-box")).text(r);$(".homepage-presell-tag-event",p.find(".img-box.recommend-homepage-img-box")).removeClass("none")}else{var v="";if(!isNullOrEmpty(s)&&s=="SOLDOUT"){v="暂无库存"}else{v="立即购买"}$(".homepage-presell-copywriter-event",p.find(".img-box.recommend-homepage-img-box")).text(v);$(".homepage-presell-mob-copywriter-event",p.find(".details-box.recommend-homepage-details-box")).text(v);if(isNullOrEmpty(t)){$(".homepage-presell-tag-event",p.find(".img-box.recommend-homepage-img-box")).addClass("none")}else{$(".homepage-presell-tag-event",p.find(".img-box.recommend-homepage-img-box")).removeClass("none")}$(".homepage-presell-tag-event",p.find(".img-box.recommend-homepage-img-box")).text(t)}}).hover(function(){if(e.getWindowWidth()<=1024){return}$(this).closest(".thumbnail").find(".img-box > a img").attr("src",$(this).data("img-src"))},function(){if(e.getWindowWidth()<=1024){return}$(this).closest(".thumbnail").find(".img-box > a img").attr("src",$(o.slides).filter(".is-active").find("span").data("img-src"))})}});$(m).data("spice.swiper",k)}else{k.update()}if(k.isBeginning&&k.isEnd){k.wrapper.addClass("is-disable");k.prevButton.addClass("none");k.nextButton.addClass("none");k.destroy(false,false)}})}b($(".goods-tab-item:visible .e-swiper-goods"));var c=true;$(window).on("scroll.index",function(){var i=$(window).scrollTop();if(i>2&&c){var j=$(".favorites-aside-content .goods-tab-item"),g=j.eq(0).find(".goods-img-details a img"),h=g.attr("clicklazysrc");g.attr("src",h);c=false}}).trigger("scroll.index");$(".favorites-aside-nav li").on("tap",function(){var i=$(".favorites-aside-content .goods-tab-item"),g=i.eq($(this).index()).find(".goods-img-details a img"),h=g.attr("clicklazysrc");$(this).addClass("is-active").siblings("li").removeClass("is-active");i.removeClass("is-active").eq($(this).index()).addClass("is-active");g.attr("src",h);b()});var a=new Swiper(".e-swiper-essentials",{speed:600,lazyLoading:true,lazyLoadingInPrevNext:true,lazyLoadingInPrevNextAmount:1,slidesPerView:2,spaceBetween:20,slidesPerGroup:2,pagination:".swiper-pagination",paginationClickable:true,observer:true,observeParents:true,nextButton:".essentials-wrapper .swiper-button-next",prevButton:".essentials-wrapper .swiper-button-prev",breakpoints:{1024:{spaceBetween:25,}},onInit:function(g){if(g.bullets.length==1){g.destroy(false);$(".e-swiper-essentials .swiper-pagination").addClass("none")}else{$(".e-swiper-essentials .swiper-pagination").removeClass("none")}if(g.slides.length==2){$(".essentials-wrapper .swiper-button-prev,.essentials-wrapper .swiper-button-next").addClass("none")}else{$(".essentials-wrapper .swiper-button-prev,.essentials-wrapper .swiper-button-next").removeClass("none")}},onSlideChangeStart:function(g){}});$(".e-play-video").on("tap",function(){try{videoStart($(this).parents(".video-left").find("img").attr("title"))}catch(g){console.log("tracking code videoStart is error")}$(this).attr("video-src",$(this).data("src"));Y.dialog.videoDialog.show()})});
$(function(){try{$(".indexkv").each(function(){var d=$(this).find("a").find("img").attr("alt");var c=$(this).find("a").attr("href");var b=$(this).attr("data-swiper-slide-index");kvImpressions(d,b,c)})}catch(a){console.log("tracking code is error")}$(".e-hp-product .goods-handle .e-quickbuy").live("tap",function(){var b=$(this).parents(".img-box").next(".details-box").find("div.swiper-slide.is-active").find("img").attr("product-code");if(isNullOrEmpty(b)){b=$(this).parents(".e-hp-product").attr("product-code")}var j=$(this).parents(".img-box").next(".details-box").find("div.swiper-slide.is-active").find("img").attr("product-id");if(isNullOrEmpty(j)){j=$(this).parents(".e-hp-product").attr("product-id")}var k=$(this).parents(".e-hp-product").find(".goods-title-cn a").html();var h="";$(".favorites-aside-nav li").each(function(){if($(this).hasClass("is-active")){h=$(this).find("span").html()}});var i=$("#"+j).val();var l=i.substring(1,i.length-1).split(",");var d="";$.each(l,function(m,n){d=d+n.substring(n.indexOf("=")+1,n.length)+"/"});d=d.substring(0,d.length-1);var f=$(this).parents(".e-hp-product").find(".goods-introudce").attr("product-size");var c=$.trim($(this).parents(".e-hp-product").find(".row").find(".goods-price span").html());c=c.substring(1,c.length);var g=$(this).parents(".e-hp-product").index()+1;try{goToCheckout(b,k,h,d,f,g,c,"1","1","")}catch(e){console.log("tracking code goToCheckout is error")}immediatelyBuy(b)});$(".e-hp-product .details-box .e-quickbuy-mob").live("tap",function(){var b=$(this).parents(".details-box").find("div.swiper-slide.is-active").find("img").attr("product-code");if(isNullOrEmpty(b)){b=$(this).parents(".e-hp-product").attr("product-code")}var j=$(this).parents(".img-box").next(".details-box").find("div.swiper-slide.is-active").find("img").attr("product-id");if(isNullOrEmpty(j)){j=$(this).parents(".e-hp-product").attr("product-id")}var k=$(this).parents(".e-hp-product").find(".goods-title-cn a").html();var h="";$(".favorites-aside-nav li").each(function(){if($(this).hasClass("is-active")){h=$(this).find("span").html()}});var i=$("#"+j).val();var l=i.substring(1,i.length-1).split(",");var d="";$.each(l,function(m,n){d=d+n.substring(n.indexOf("=")+1,n.length)+"/"});d=d.substring(0,d.length-1);var f=$(this).parents(".e-hp-product").find(".goods-introudce").attr("product-size");var c=$.trim($(this).parents(".e-hp-product").find(".row").find(".goods-price span").html());c=c.substring(1,c.length);var g=$(this).parents(".e-hp-product").index()+1;try{goToPdp(b,k,h,d,f,g,c)}catch(e){console.log("tracking code goToPdp is error")}window.open("/item/"+b)});$(".e-hp-product .e-index-topdp").live("tap",function(){var b=$(this).parents(".img-box").next(".details-box").find("div.swiper-slide.is-active").find("img").attr("product-code");var j=$(this).parents(".img-box").next(".details-box").find("div.swiper-slide.is-active").find("img").attr("product-id");if(isNullOrEmpty(b)){b=$(this).parents(".e-hp-product").attr("product-code")}if(isNullOrEmpty(j)){j=$(this).parents(".e-hp-product").attr("product-id")}var k=$(this).parents(".e-hp-product").find(".goods-title-cn a").html();var h="";$(".favorites-aside-nav li").each(function(){if($(this).hasClass("is-active")){h=$(this).find("span").html()}});var i=$("#"+j).val();var l=i.substring(1,i.length-1).split(",");var d="";$.each(l,function(m,n){d=d+n.substring(n.indexOf("=")+1,n.length)+"/"});d=d.substring(0,d.length-1);var f=$(this).parents(".e-hp-product").find(".goods-introudce").attr("product-size");var c=$.trim($(this).parents(".e-hp-product").find(".row").find(".goods-price span").html());c=c.substring(1,c.length);var g=$(this).parents(".e-hp-product").index()+1;try{goToPdp(b,k,h,d,f,g,c)}catch(e){console.log("tracking code goToPdp is error")}window.open("/item/"+b)});$(".e-hp-product .e-item-display-color .e-swiper-color .swiper-slide").live("tap",function(){var e=$(this).find("img").attr("product-code");var c=$(this).find("img").attr("data-saleprice");var d=$(this).find("img").attr("data-title");var b=$(this).find("img").attr("data-subtitle");if(!isNullOrEmpty(e)){$(this).parents(".details-box").find(".goods-title-cn").find("a").text(d);$(this).parents(".details-box").find(".goods-tit").find("a").text(b);$(this).parents(".details-box").find(".goods-price").find("span").text("¥"+c)}});$(".indexkv").live("tap",function(){var c=$(this).find("a").attr("href");var b=$(this).attr("data-swiper-slide-index")+1;try{clickKv(c,b)}catch(d){console.log("tracking code clickKv is error")}});$(".goods-btn-next").live("tap",function(){var c="";$(".favorites-aside-nav li").each(function(){if($(this).hasClass("is-active")){c=$(this).find("span").html()}});try{starProduct(c,"next")}catch(b){console.log("tracking code starProduct is error")}});$(".goods-btn-prev").live("tap",function(){var c="";$(".favorites-aside-nav li").each(function(){if($(this).hasClass("is-active")){c=$(this).find("span").html()}});try{starProduct(c,"previous")}catch(b){console.log("tracking code starProduct is error")}})});function kvImpressions(c,b,a){_ha("send","action","promotion_impressions",{promotion_id:"",promotion_name:"",promotion_utl:a,promotion_creative:c,promotion_position:b,})};
var localHandlerbars={compiledTemplates:[],getTemplateFromCache:function(b){if(localHandlerbars.compiledTemplates[b]===undefined){var a=Handlebars.compile($("#"+b).html());Handlebars.registerHelper(handlerbarHelpers);localHandlerbars.compiledTemplates[b]=a;return a}return localHandlerbars.compiledTemplates[b]},render:function(d,a,e){var c=localHandlerbars.getTemplateFromCache(e);var b=c(a);d.html(b)},getTemplate:function(b){var a=Handlebars.compile(b);Handlebars.registerHelper(handlerbarHelpers);return a},getTemplateHtml:function(b,c){var a=localHandlerbars.getTemplate(b);return a(c)},renderToSelector:function(d,c,b){var a=b(c);d.html(a)},};var handlerbarHelpers={imageUrlHelper:function(b,a){if($.type(b)=="array"&&b.length>0){b=b[0].picUrl}var c="";if(null==a||""==a||undefined==a||$.type(a)!="string"){c=imgbase+b}else{c=formatImage(b,a)}return c},imageStaticHelper:function(b){var a=staticbase+b;return a},itemRankAvg:function(a){var a=a*100/5;return a},hrefHelper:function(b,a){if(b==null||b.length==0||b==""){return base+"/item/"+a}else{return base+"/item/"+b.replace(" ","-").toLowerCase()+"/"+a}},fmtPrice:function(a){return toInteger(a)},fmtMoney:function(a){return toDecimal2(a)},priceCompareHelper:function(c,a,b){if(c!=a){return b.fn(this)}return b.inverse(this)},formatDateHelper:function(a,b){return moment(a).format(b)},equals:function(c,b,a){if(c==b){return a.fn(this)}return a.inverse(this)},notEquals:function(c,b,a){if(c==b){return a.inverse(this)}return a.fn(this)},comparing:function(c,b,a){if(c>b){return a.fn(this)}return a.inverse(this)},priceHelper:function(c,b){var a="";if(null==c||""==c||undefined==c){c=0}if(null==b||""==b||undefined==b){b=0}if(c==b){a="¥"+toDecimal2(c)}else{a="¥"+toDecimal2(c)+"<del>¥"+toDecimal2(b)+"</del>"}return a},adpriceHelper:function(c,b){var a="";if(null==c||""==c||undefined==c){c=0}if(null==b||""==b||undefined==b){b=0}if(c==b){a="¥"+plpPrice(c)/1}else{a="<span class='goods-price'> ¥ "+plpPrice(c)/1+"<del class='original-price'>¥"+plpPrice(b)/1+"</del></span>"}return a},listSizeHelper:function(c){var b=0;for(var a=1;a<=c.length;a++){b+=1}return b},miadidasHelper:function(a,c,d){var b="";if(a||c){b="<div class='detail'><span>miadidas定制</span> <i class='icon icon-miadidas'></i></div>"}else{if(!a&&d){b="<div class='detail'><span>个性印制</span> <i class='icon icon-personality'></i></div>"}}if(!a&&!d){}return b},dailogPriceHelper:function(c,b){var a="";if(null==c||""==c||undefined==c){c=0}if(null==b||""==b||undefined==b){b=0}if(c==b){a="HK$"+toDecimal2(c)}else{a="HK$"+toDecimal2(c)+"<del> HK$"+toDecimal2(b)+"</del>"}return a},fnSubString:function(c,b,a){if(c.length>a){return c.substring(b,a)}else{return c}},isNotNullOrEmpty:function(b,a){if(b==null||b.length==0||b==""){return a.inverse(this)}return a.fn(this)},toUpperCase:function(a){if(a==null||a.length==0||a==""){return""}return a.toUpperCase()},indexBetween:function(c,d,a,b){if(c>=d&&c<=a){return b.fn(this)}return b.inverse(this)},getI18NMessage:function(a){if(a==null||a.length==0||a==""){console.log("I18N code is null");return""}var b=loxia.getLocaleMsg(a);if(a==null||a.length==0||a==""){return""}return b},getI18NMessageFormat:function(b,a){if(b==null||b.length==0||b==""){console.log("I18N code is null");return""}var c=loxia.getLocaleMsg(b,a);if(b==null||b.length==0||b==""){return""}return c},iflocal:function(v1,operator,v2,options){switch(operator){case"==":return(v1==v2)?options.fn(this):options.inverse(this);case"!=":return(v1!=v2)?options.fn(this):options.inverse(this);case"===":return(v1===v2)?options.fn(this):options.inverse(this);case"!==":return(v1!==v2)?options.fn(this):options.inverse(this);case"&&":return(v1&&v2)?options.fn(this):options.inverse(this);case"||":return(v1||v2)?options.fn(this):options.inverse(this);case"<":return(v1<v2)?options.fn(this):options.inverse(this);case"<=":return(v1<=v2)?options.fn(this):options.inverse(this);case">":return(v1>v2)?options.fn(this):options.inverse(this);case">=":return(v1>=v2)?options.fn(this):options.inverse(this);default:return eval(""+v1+operator+v2)?options.fn(this):options.inverse(this)}},subStrBefore:function(a,b){return a.split(b)[0]},subStrAfter:function(a,b){return a.split(b)[1]},ifnot:function(b,a){return(!b)?a.fn(this):a.inverse(this)},skuIvtLiHelper:function(c){var b="";for(var a=0;a<c;a++){b+="<li><a>"+(a+1)+"</a></li>"}return b},skuIvtOptionHelper:function(c){var b="";for(var a=0;a<c;a++){b+="<option value="+(a+1)+">"+(a+1)+"</option>"}return b},htmlConvertHelper:function(b){var a=b;return a}};function loadJsonjsonDataAndRenderTemplateHtmlToSelector(a){console.log("renderConfig is:%o",a);loxia.asyncXhrPost(a.url,a.params,{success:function(d){if(null!=d&&""!=d&&!$.isEmptyObject(d)){console.log("return jsonData:%o",d);var b=true;if($.isFunction(a.beforeRenderjsonDataEvent)){b=a.beforeRenderjsonDataEvent(d)}if(!b){return}var c=getHandlebarsTemplate($(a.renderTemplateSelector).html());renderTemplateHtmlToSelector(a.renderToSelector,a.parseRenderjsonData(d),c);if($.isFunction(a.afterRenderjsonDataEvent)){a.afterRenderjsonDataEvent(d)}}else{console.warn("[%o] jsonData is null or empty,nothing to do!!!",a.renderToSelector)}}},{error:function(b){console.log(b)}})}function formatImage(e,c){if(null==e||undefined==e||""==e){return defaultImg}var a=e.lastIndexOf(".");var b=e.lastIndexOf("_");var d="";if(b!=-1){d=e.substring(0,b)}else{d=e.substring(0,a)}if("source"!=c){d=d+"_";d=d+c}d=imgbase+d+e.substring(a);return d}function toInteger(a){return parseInt(a)}function toDecimal2(a){var d=parseFloat(a);if(isNaN(d)){return false}var d=Math.round(a*100)/100;var c=d.toString();var b=c.indexOf(".");if(b<0){b=c.length;c+="."}while(c.length<=b+2){c+="0"}return c}function plpPrice(a){var b=null;if(a<1){b=0}if(a>1){b=a}return b}String.format=function(d,a){if(a.length==0){return null}for(var b=1;b<a.length;b++){var c=new RegExp("\\{"+(b-1)+"\\}","gm");d=d.replace(c,arguments[b])}return d};